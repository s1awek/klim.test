import{b as k,a0 as Z,d as K,t as ee,r as m,S as te,o as i,e as w,w as A,c as u,a as b,U as O,u as l,f as _,R as ae,i as V,h as D,p as M,n as ne,$ as U}from"../apps/settings/index.0FToouit.js";import{_ as se}from"./GroupEditFields.vue_vue_type_script_setup_true_lang.BHnpEQ8A.js";import{A as $}from"./index.CL4_wdF3.js";import{E as oe}from"./EditOutlined.KbemwFb1.js";import{D as ie}from"./DeleteOutlined.BPTeAZVG.js";import{A as le}from"./index.1EK9wRFW.js";var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};function z(c){for(var o=1;o<arguments.length;o++){var r=arguments[o]!=null?Object(arguments[o]):{},p=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(p=p.concat(Object.getOwnPropertySymbols(r).filter(function(v){return Object.getOwnPropertyDescriptor(r,v).enumerable}))),p.forEach(function(v){ce(c,v,r[v])})}return c}function ce(c,o,r){return o in c?Object.defineProperty(c,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):c[o]=r,c}var H=function(o,r){var p=z({},o,r.attrs);return k(Z,z({},p,{icon:re}),null)};H.displayName="SaveOutlined";H.inheritAttrs=!1;const de={key:0,class:"editable-row-operations"},ue={class:"editable-cell"},fe=["loading","onClick"],pe=["onClick"],ve={key:0},ye=["innerHTML"],me={key:1},be=["innerHTML"],Ce=K({__name:"DataTableControl",props:{params:{type:Object,required:!0},data:{type:Object,required:!0},editFields:{type:Object,required:!1,default:()=>({})}},emits:["fieldData","fieldUpdatedData","fieldUpdatedPopupData","fieldDeletedData"],setup(c,{emit:o}){var T,x;const r=c,{params:p,data:v,editFields:L}=ee(r),f=p.value,N=m((T=f.paginated)!=null?T:!1),B=f.fields,E=m(f.classes),g=m(v),q=f.editable,F=f.can_delete,I=f.edit_action,R=f.delete_action,C=m((x=f.inline_edit)!=null?x:!0),S=m(!1),d=te([]),h=o,j=m([]),J=e=>{for(const[a,n]of Object.entries(e))j.value[a]=n},G=e=>{d[e]=window.lodash.cloneDeep(g.value.filter(a=>e===a.key)[0]),j.value=d[e],C.value===!1?h("fieldUpdatedPopupData",d[e]):h("fieldUpdatedData",d[e])},Q=async e=>{const a=[{key:"action",value:I}],n={};n.key=e;for(const[t,s]of Object.entries(j.value)){let y=s;typeof s=="object"&&s!==null&&(y=JSON.stringify(s)),a.push({key:t,value:y}),n[t]=s}try{await U(a)==="success"&&h("fieldUpdatedData",n)}catch(t){console.error(t)}finally{S.value=!1}delete d[e]},W=async e=>{const a=g.value.filter(t=>e===t.key)[0],n=[{key:"action",value:R}];for(const[t,s]of Object.entries(a))n.push({key:t,value:s});try{await U(n)==="success"&&h("fieldDeletedData",e)}catch(t){console.error(t)}finally{S.value=!1}},X=e=>{delete d[e]},Y=e=>{const a=[];for(const[n,t]of Object.entries(L.value))a[t.id]=t;return typeof a[e]<"u"?a[e]:{}},P=e=>Array.isArray(e)?e.join(", "):e;return(e,a)=>(i(),w(l(le),{class:ne(E.value),"data-source":g.value,columns:l(B),pagination:N.value,bordered:""},{bodyCell:A(({column:n,text:t,record:s})=>[n.key==="operation"?(i(),u("div",de,[b("div",ue,[d[s.key]&&C.value?(i(),u(O,{key:0},[b("a",{loading:S.value,onClick:y=>Q(s.key)},[k(l(H))],8,fe),a[0]||(a[0]=_("   ")),k(l($),{title:"Sure to cancel?",onConfirm:y=>X(s.key)},{default:A(()=>[b("a",null,[k(l(ae))])]),_:2},1032,["onConfirm"])],64)):(i(),u(O,{key:1},[l(q)?(i(),u("a",{key:0,onClick:y=>G(s.key)},[k(l(oe))],8,pe)):V("",!0),a[1]||(a[1]=_("   ")),l(F)?(i(),u(O,{key:1},[g.value.length?(i(),w(l($),{key:0,title:"Sure to delete?",onConfirm:y=>W(s.key)},{default:A(()=>[b("a",null,[k(l(ie))])]),_:2},1032,["onConfirm"])):V("",!0)],64)):V("",!0)],64))])])):(i(),u(O,{key:1},[C.value?(i(),u("div",ve,[d[s.key]?(i(),w(se,{key:0,"editable-data":d[s.key],"field-value":d[s.key][n.dataIndex],"field-data":Y(n.field),onFieldUpdatedData:J},null,8,["editable-data","field-value","field-data"])):(i(),u(O,{key:1},[_(D(n.prefix)+" ",1),b("span",{innerHTML:l(M)(P(t))},null,8,ye),_(" "+D(n.suffix),1)],64))])):(i(),u("div",me,[_(D(n.prefix)+" ",1),b("span",{innerHTML:l(M)(P(t))},null,8,be),_(" "+D(n.suffix),1)]))],64))]),_:1},8,["class","data-source","columns","pagination"]))}});export{Ce as _};
