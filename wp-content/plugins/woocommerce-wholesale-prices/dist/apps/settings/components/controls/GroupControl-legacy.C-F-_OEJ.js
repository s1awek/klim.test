System.register(["../../index-legacy.D_HQ7UHt.js","../../../../common/settings-store-legacy.CBbG64Gq.js","../../../../common/DataTableControl.vue_vue_type_script_setup_true_lang-legacy._WQlmiIJ.js","../../../../common/index-legacy.CZsp51nD.js","../../../../common/GroupControl.vue_vue_type_style_index_0_scoped_ac0e52be_lang-legacy.BhDSN6Mf.js","../../../../common/_plugin-vue_export-helper-legacy.BVIICed7.js","../../../../common/GroupEditFields.vue_vue_type_script_setup_true_lang-legacy.CSn1h-l8.js","../../../../common/index-legacy.DuRohshj.js","../../../../common/FormItemContext-legacy.D1JWf5Lb.js","../../../../common/createContext-legacy.BEVKniUZ.js","../../../../common/statusUtils-legacy.CiSm313W.js","../../../../common/motion-legacy.DaDvaV3z.js","../../../../common/SearchOutlined-legacy.Cdgdkuex.js","../../../../common/compact-item-legacy.CSenwEfn.js","../../../../common/index-legacy.BxxedCbU.js","../../../../common/isPlainObject-legacy.CpsnRU5w.js","../../../../common/index-legacy.CJGJV8p0.js","../../../../common/index-legacy.mdDj8pzG.js","../../../../common/KeyCode-legacy.zo7Ifc6W.js","../../../../common/pickAttrs-legacy.D-nWOg4u.js","../../../../common/slide-legacy.Bc6KnDsM.js","../../../../common/isMobile-legacy.B1xuVHMd.js","../../../../common/useMergedState-legacy.BnDPKCDY.js","../../../../common/useState-legacy.DRA39OiQ.js","../../../../common/DownOutlined-legacy.BK78QkNv.js","../../../../common/index-legacy.B2gNFwGx.js","../../../../common/index-legacy.B22f4Bi8.js","../../../../common/index-legacy.Bzt1D6qi.js","../../../../common/warning-legacy.CsQLB1iG.js","../../../../common/index-legacy.Dc6Q8xCb.js","../../../../common/index-legacy.CmnYj8HR.js","../../../../common/ActionButton-legacy.Bmf66kj_.js","../../../../common/EditOutlined-legacy.DA-DPmkm.js","../../../../common/DeleteOutlined-legacy.BsKdC1O1.js","../../../../common/index-legacy.zzIifafH.js","../../../../common/index-legacy.Cq1tSVl0.js","../../../../common/index-legacy.BMrlQ3Sf.js","../../../../common/Checkbox-legacy.jGeSWg3n.js","../../../../common/index-legacy.DM4evxx4.js","../../../../common/debounce-legacy.BJRaRtOy.js"],function(e,l){"use strict";var n,a,o,t,i,u,d,c,s,m,v,r,y,f,p,g,j,_,b,x,h,k,D,O,C,S,U;return{setters:[e=>{n=e.d,a=e.t,o=e.s,t=e.r,i=e.S,u=e.c,d=e.o,c=e.a,s=e.U,m=e.V,v=e.e,r=e.w,y=e.W,f=e.u,p=e.X,g=e.b,j=e.Y,_=e.Z,b=e.f,x=e.h,h=e.i,k=e.n,D=e.$},e=>{O=e.u},e=>{C=e._},e=>{S=e.B},null,e=>{U=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l=["id"],A={class:"data-table-buttons"},F={class:"data-table"};e("default",U(n({__name:"GroupControl",props:{params:{type:Object,required:!0},conditionalValues:{type:Object,required:!1,default:()=>({})}},emits:["input","fieldData","selectedCondition","conditionalData","selectedDependent","fieldUpdatedData","fieldUpdatedPopupData"],setup(e,{emit:n}){const U=e,{params:w}=a(U),V=O(),{selectedConditionKey:E,selectedConditionValue:G,groupData:I}=o(V),M=n,P=w.value,q=P.classes,B=P.id,K=t(P.fields),N=i({fields:K.value}),T=t(P.table.data),W=P.group_action,X=t(P.table?.inline_edit??!0),Y=t(!1),Z=t([]),$=t([]);if(void 0!==I.value&&Object.keys(I.value).length>0&&void 0!==I.value[B]&&(T.value=I.value[B]),N.fields)for(const[l,a]of Object.entries(N.fields)){const e=a;Z.value[e.id]=e.default}const J=e=>{Object.entries(e).forEach(([e,l])=>{Z.value[e]=l})};void 0!==K.value&&null!==K.value&&(N.fields=K.value.filter(e=>void 0===e.hide||null===e.hide||!e.hide));const Q=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;N.fields=K.value.filter(e=>{if(void 0!==e.condition&&null!==e.condition){const a=e.condition.find(e=>e.key===l);return"yes"===a.value&&"yes"===n||"no"===a.value&&"no"===n}return!0}),$.value[l]=n},R=e=>{Object.assign(T.value.filter(l=>e.key===l.key)[0],e),I.value[B]=T.value},z=e=>{T.value=T.value.filter(l=>l.key!==e),I.value[B]=T.value},H=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;N.fields=K.value.filter(e=>{const a=K.value.find(l=>l.id===e.id);if(a){if(void 0!==a.condition&&null!==a.condition){const o=a.condition.find(e=>e.key===l);return!(void 0===o||o.key!==l||(Array.isArray(o.value)||o.value!==n)&&(!Array.isArray(o.value)||!o.value.includes(n))||(void 0!==Z.value[a.id]&&null!==Z.value[a.id]&&(e.default=Z.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),0))}return void 0!==Z.value[a.id]&&null!==Z.value[a.id]&&(e.default=Z.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),!0}return!1})},L=e=>{N.fields=K.value.filter(e=>{const l=K.value.find(l=>l.id===e.id);return!(!l||void 0!==l.hide&&null!==l.hide&&l.hide||(void 0!==Z.value[l.id]&&null!==Z.value[l.id]&&(e.default=Z.value[l.id]),void 0!==l.dependent_option&&null!==l.dependent_option&&(e.default=l.dependent_default),0))})},ee=async()=>{Y.value=!0;const e=[{key:"action",value:W}],l={};let n=0;if(T.value.length>0){let e=T.value.map(e=>e.key);n=Math.max(...e)+1}l.key=n;for(const[o,t]of Object.entries(Z.value)){let n=t;"object"==typeof t&&null!==t&&(n=JSON.stringify(t)),e.push({key:o,value:n});let a=t;const i=K.value.find(e=>e.id===o);void 0!==i&&void 0!==i.prefix&&(a=i.prefix+t),l[o]=a}Z.value=[];try{"success"===await D(e)&&(T.value.push(l),I.value[B]=T.value,E.value="",G.value="",X.value||M("fieldUpdatedData",l)),Y.value=!1}catch(a){console.error(a)}finally{Y.value=!1}};return(e,n)=>(d(),u("div",{id:f(B),class:k(f(q))},[(d(!0),u(s,null,m(N.fields,(e,l)=>(d(),u("div",{key:l},[(d(),v(_,null,{fallback:r(()=>[g(j)]),default:r(()=>[(d(),v(y(f(p)(e.type)),{params:e,"conditional-values":$.value,onFieldData:J,onConditionalData:Q,onSelectedCondition:H,onSelectedDependent:L},null,40,["params","conditional-values"]))]),_:2},1024))]))),128)),c("div",A,[""!==f(P).button_label?(d(),v(f(S),{key:0,type:"primary",class:"save-group-btn",loading:Y.value,onClick:ee},{default:r(()=>[x(h(f(P).button_label),1)]),_:1},8,["loading"])):b("",!0)]),c("div",F,[g(C,{params:f(P).table,data:T.value,"edit-fields":K.value,onFieldUpdatedData:R,onFieldDeletedData:z},null,8,["params","data","edit-fields"])])],10,l))}}),[["__scopeId","data-v-ac0e52be"]]))}}});
