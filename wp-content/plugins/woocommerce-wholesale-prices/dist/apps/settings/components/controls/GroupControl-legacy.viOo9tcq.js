System.register(["../../index-legacy.CV2KRSvP.js","../../../../common/settings-store-legacy.BxiOnfTQ.js","../../../../common/DataTableControl.vue_vue_type_script_setup_true_lang-legacy.DkHsUU2W.js","../../../../common/index-legacy.BSsFDV5a.js","../../../../common/GroupControl.vue_vue_type_style_index_0_scoped_ac0e52be_lang-legacy.DziZu4pi.js","../../../../common/_plugin-vue_export-helper-legacy.DgAO6S8O.js","../../../../common/GroupEditFields.vue_vue_type_script_setup_true_lang-legacy.Dxy3PDwb.js","../../../../common/index-legacy.B6hLZ144.js","../../../../common/FormItemContext-legacy.jBHODEUn.js","../../../../common/createContext-legacy.96H2Yoah.js","../../../../common/statusUtils-legacy.BGs5qAWe.js","../../../../common/motion-legacy.Zihzw6dt.js","../../../../common/SearchOutlined-legacy.Pk55rQZy.js","../../../../common/compact-item-legacy.CCNfvECR.js","../../../../common/index-legacy.blUSygk5.js","../../../../common/isPlainObject-legacy.vrjuBUmR.js","../../../../common/index-legacy.DkbBLQ9W.js","../../../../common/index-legacy.BpJpa4uf.js","../../../../common/KeyCode-legacy.CYgXvjDm.js","../../../../common/pickAttrs-legacy.DPO-BtYK.js","../../../../common/slide-legacy.DmmVVGXc.js","../../../../common/isMobile-legacy.u4Sbg_0V.js","../../../../common/useMergedState-legacy.llXgCMNj.js","../../../../common/useState-legacy.blkaH1TT.js","../../../../common/DownOutlined-legacy.DJvkskTM.js","../../../../common/index-legacy.DeQJ31SE.js","../../../../common/index-legacy.QVxX_DIq.js","../../../../common/index-legacy.CquitJWk.js","../../../../common/warning-legacy.BV4CRm2j.js","../../../../common/index-legacy.ZEOhfVRA.js","../../../../common/index-legacy.DHEvdWU1.js","../../../../common/ActionButton-legacy.O-A9_Hz4.js","../../../../common/EditOutlined-legacy.BZ8mIl-g.js","../../../../common/DeleteOutlined-legacy.KvWF-zoM.js","../../../../common/index-legacy.CaBoHDtx.js","../../../../common/index-legacy.BzwncoNc.js","../../../../common/index-legacy.BN9L2hgN.js","../../../../common/Checkbox-legacy.BupS-T6E.js","../../../../common/index-legacy.CLBq9Skg.js","../../../../common/debounce-legacy.B3khENQc.js"],(function(e,l){"use strict";var n,a,o,t,i,u,d,c,s,m,v,r,y,f,p,g,j,_,b,x,h,k,D,O,C,S,U;return{setters:[e=>{n=e.d,a=e.t,o=e.s,t=e.r,i=e.S,u=e.o,d=e.c,c=e.U,s=e.V,m=e.e,v=e.w,r=e.b,y=e.W,f=e.X,p=e.u,g=e.Y,j=e.Z,_=e.a,b=e.f,x=e.h,h=e.i,k=e.n,D=e.$},e=>{O=e.u},e=>{C=e._},e=>{S=e.B},null,e=>{U=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l=["id"],A={class:"data-table-buttons"},F={class:"data-table"};e("default",U(n({__name:"GroupControl",props:{params:{type:Object,required:!0},conditionalValues:{type:Object,required:!1,default:()=>({})}},emits:["input","fieldData","selectedCondition","conditionalData","selectedDependent","fieldUpdatedData","fieldUpdatedPopupData"],setup(e,{emit:n}){var U,w;const V=e,{params:E}=a(V),G=O(),{selectedConditionKey:I,selectedConditionValue:M,groupData:P}=o(G),q=n,B=E.value,K=B.classes,N=B.id,T=t(B.fields),W=i({fields:T.value}),X=t(B.table.data),Y=B.group_action,Z=t(null===(U=null===(w=B.table)||void 0===w?void 0:w.inline_edit)||void 0===U||U),$=t(!1),J=t([]),Q=t([]);if(void 0!==P.value&&Object.keys(P.value).length>0&&void 0!==P.value[N]&&(X.value=P.value[N]),W.fields)for(const[l,a]of Object.entries(W.fields)){const e=a;J.value[e.id]=e.default}const R=e=>{Object.entries(e).forEach((([e,l])=>{J.value[e]=l}))};void 0!==T.value&&null!==T.value&&(W.fields=T.value.filter((e=>void 0===e.hide||null===e.hide||!e.hide)));const z=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;W.fields=T.value.filter((e=>{if(void 0!==e.condition&&null!==e.condition){const a=e.condition.find((e=>e.key===l));return"yes"===a.value&&"yes"===n||"no"===a.value&&"no"===n}return!0})),Q.value[l]=n},H=e=>{Object.assign(X.value.filter((l=>e.key===l.key))[0],e),P.value[N]=X.value},L=e=>{X.value=X.value.filter((l=>l.key!==e)),P.value[N]=X.value},ee=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;W.fields=T.value.filter((e=>{const a=T.value.find((l=>l.id===e.id));if(a){if(void 0!==a.condition&&null!==a.condition){const o=a.condition.find((e=>e.key===l));return!(void 0===o||o.key!==l||(Array.isArray(o.value)||o.value!==n)&&(!Array.isArray(o.value)||!o.value.includes(n))||(void 0!==J.value[a.id]&&null!==J.value[a.id]&&(e.default=J.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),0))}return void 0!==J.value[a.id]&&null!==J.value[a.id]&&(e.default=J.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),!0}return!1}))},le=e=>{W.fields=T.value.filter((e=>{const l=T.value.find((l=>l.id===e.id));return!(!l||void 0!==l.hide&&null!==l.hide&&l.hide||(void 0!==J.value[l.id]&&null!==J.value[l.id]&&(e.default=J.value[l.id]),void 0!==l.dependent_option&&null!==l.dependent_option&&(e.default=l.dependent_default),0))}))},ne=async()=>{$.value=!0;const e=[{key:"action",value:Y}],l={};let n=0;if(X.value.length>0){let e=X.value.map((e=>e.key));n=Math.max(...e)+1}l.key=n;for(const[o,t]of Object.entries(J.value)){let n=t;"object"==typeof t&&null!==t&&(n=JSON.stringify(t)),e.push({key:o,value:n});let a=t;const i=T.value.find((e=>e.id===o));void 0!==i&&void 0!==i.prefix&&(a=i.prefix+t),l[o]=a}J.value=[];try{"success"===await D(e)&&(X.value.push(l),P.value[N]=X.value,I.value="",M.value="",Z.value||q("fieldUpdatedData",l)),$.value=!1}catch(a){console.error(a)}finally{$.value=!1}};return(e,n)=>(u(),d("div",{id:p(N),class:k(p(K))},[(u(!0),d(c,null,s(W.fields,((e,l)=>(u(),d("div",{key:l},[(u(),m(j,null,{fallback:v((()=>[r(y)])),default:v((()=>[(u(),m(f(p(g)(e.type)),{params:e,"conditional-values":Q.value,onFieldData:R,onConditionalData:z,onSelectedCondition:ee,onSelectedDependent:le},null,40,["params","conditional-values"]))])),_:2},1024))])))),128)),_("div",A,[""!==p(B).button_label?(u(),m(p(S),{key:0,type:"primary",class:"save-group-btn",loading:$.value,onClick:ne},{default:v((()=>[b(x(p(B).button_label),1)])),_:1},8,["loading"])):h("",!0)]),_("div",F,[r(C,{params:p(B).table,data:X.value,"edit-fields":T.value,onFieldUpdatedData:H,onFieldDeletedData:L},null,8,["params","data","edit-fields"])])],10,l))}}),[["__scopeId","data-v-ac0e52be"]]))}}}));
